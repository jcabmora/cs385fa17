<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lab No. 01: Deploying an Application to Google Cloud &#8212; CS385 Cloud Systems Architecture  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab No. 02: Scaling" href="../lab02/lab02.html" />
    <link rel="prev" title="CS385 Cloud Systems Architecture" href="../../syllabus.html" />
<link href="https://fonts.googleapis.com/css?family=Lusitana|Inconsolata|Roboto" rel="stylesheet">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          CS385 Cloud Systems Architecture</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../syllabus.html">CS385 Cloud Systems Architecture</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lab No. 01: Deploying an Application to Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab02/lab02.html">Lab No. 02: Scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab03/lab03.html">Lab 03: Automating Deployment with REST APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab03/lab03.html#create-a-controller-host">Create a Controller Host</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab03/lab03.html#enable-credentials">Enable credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab03/lab03.html#use-the-google-cloud-compute-python-api">Use the Google Cloud Compute Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab03/lab03.html#useful-links">Useful Links</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Lab No. 01: Deploying an Application to Google Cloud</a><ul>
<li><a class="reference internal" href="#deploying-a-virtual-machine">Deploying a Virtual Machine</a></li>
<li><a class="reference internal" href="#access-to-the-virtual-machine">Access to the Virtual Machine</a><ul>
<li><a class="reference internal" href="#browser-access">Browser access</a></li>
<li><a class="reference internal" href="#command-line-ssh-access">Command Line SSH Access</a></li>
<li><a class="reference internal" href="#run-a-linux-container">Run a Linux Container</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stop-the-virtual-machine">Stop the Virtual Machine</a></li>
<li><a class="reference internal" href="#report">Report</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../../syllabus.html" title="Previous Chapter: CS385 Cloud Systems Architecture"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CS385 Cloud S...</span>
    </a>
  </li>
  <li>
    <a href="../lab02/lab02.html" title="Next Chapter: Lab No. 02: Scaling"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Lab No. 02: Scaling &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/labs/lab01/lab01.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="lab-no-01-deploying-an-application-to-google-cloud">
<h1>Lab No. 01: Deploying an Application to Google Cloud<a class="headerlink" href="#lab-no-01-deploying-an-application-to-google-cloud" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this Lab is to familiarize students with the tools available within the Google Cloud Platform.</p>
<p>This lab assumes that you have already completed the account registration process and that you have access to the Google Cloud Platform Console.</p>
<div class="section" id="deploying-a-virtual-machine">
<h2>Deploying a Virtual Machine<a class="headerlink" href="#deploying-a-virtual-machine" title="Permalink to this headline">¶</a></h2>
<p>In this section you will create a virtual machine and deploy a simple service.</p>
<ol class="arabic">
<li><p class="first">Login to the Google Cloud Platform Console</p>
</li>
<li><p class="first">On the Left Navigation Bar, from the <strong>COMPUTE</strong> section, select <strong>Compute Engine &gt; VM Instances</strong>. This operation might take a minute or two the first time.  You will be presented with the following dialog</p>
<blockquote>
<div><img alt="../../_images/emptyinstances_dialog.png" src="../../_images/emptyinstances_dialog.png" />
</div></blockquote>
</li>
<li><p class="first">Click <strong>Create</strong>.  This might take a minute or two the first time. You will be presented with the <strong>Create an instance</strong> dialog.</p>
</li>
<li><p class="first">Notice the diffent options that are available for <strong>Machine Type</strong>.  Click on the <strong>Customize</strong> link and inspect the different options that are available.  Also notice that the selections you maka determine the cost per hour of the instance.</p>
</li>
<li><p class="first">For this lab we are going to create an instance of the lowest possible cost. Go back to the <strong>Basic View</strong>, and select “micro (1 shared vCPU/0.6 GB memory)” as the instance type.</p>
</li>
<li><p class="first">Under <strong>Boot Disk</strong>, chick on “Change”, and notice that you are provided with several preconfigured images.  Select ubuntu 16.04 LTS, using a standard persistent disk of 10 GB.</p>
</li>
<li><p class="first">Under <strong>Firewall</strong>, enable both HTTP and HTTPS traffic.</p>
</li>
<li><p class="first">Under <strong>Management</strong> provide a meaningful description of your own choice.</p>
</li>
<li><p class="first">Let the options under <strong>Disks</strong>, <strong>Networking</strong> amd <strong>SSH Keys</strong> default.</p>
</li>
<li><p class="first">Notice at the bottom of the page there is a link <strong>Equivalent REST or command line</strong>.  Copy those values and save them.  We will use those in later Labs.</p>
</li>
<li><p class="first">Click on <strong>Create</strong>.  Wait for a couple of minutes.  Once this has completed, you should see the newly created instance on the “VM Instances” Console:</p>
</li>
</ol>
</div>
<div class="section" id="access-to-the-virtual-machine">
<h2>Access to the Virtual Machine<a class="headerlink" href="#access-to-the-virtual-machine" title="Permalink to this headline">¶</a></h2>
<div class="section" id="browser-access">
<h3>Browser access<a class="headerlink" href="#browser-access" title="Permalink to this headline">¶</a></h3>
<p>You can get shell access to the newly created Virtual Machine through the Google Cloud Platform web interface.  Select the “Open in browser window” option from the “Connect” drop down menu:</p>
<img alt="../../_images/ssh-browser.png" src="../../_images/ssh-browser.png" />
<p>This will open an SSH session that runs on a browser.</p>
</div>
<div class="section" id="command-line-ssh-access">
<h3>Command Line SSH Access<a class="headerlink" href="#command-line-ssh-access" title="Permalink to this headline">¶</a></h3>
<p>In order to be able to connect to the Virtual machine we just created using a normal terminal, you need first to set up SSH keys.  Note that anyone that gets access to your keys will potentially able to get access to your machine(s), so you need to be very careful to not leave keys on systems that are accessible to others. It is highly encouraged to use a passphrase when creating your keys.</p>
<ol class="arabic">
<li><p class="first">Open a terminal and use the <code class="docutils literal"><span class="pre">ssh-keygen</span></code> command to generate a new key pair.  Make sure that you provide a <cite>-C</cite> parameter which is used by Google Cloud Platform to identify the user.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">jorge</span><span class="nd">@chronos</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span> <span class="o">-</span><span class="n">b</span> <span class="mi">2048</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_gcp</span> <span class="o">-</span><span class="n">C</span> <span class="n">jorge</span>
<span class="n">Generating</span> <span class="n">public</span><span class="o">/</span><span class="n">private</span> <span class="n">rsa</span> <span class="n">key</span> <span class="n">pair</span><span class="o">.</span>
<span class="n">Enter</span> <span class="n">passphrase</span> <span class="p">(</span><span class="n">empty</span> <span class="k">for</span> <span class="n">no</span> <span class="n">passphrase</span><span class="p">):</span>
<span class="n">Enter</span> <span class="n">same</span> <span class="n">passphrase</span> <span class="n">again</span><span class="p">:</span>
<span class="n">Your</span> <span class="n">identification</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jorge</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_gcp</span><span class="o">.</span>
<span class="n">Your</span> <span class="n">public</span> <span class="n">key</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jorge</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_gcp</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span>
<span class="n">The</span> <span class="n">key</span> <span class="n">fingerprint</span> <span class="ow">is</span><span class="p">:</span>
<span class="n">SHA256</span><span class="p">:</span><span class="mi">2</span><span class="n">VAeZPZ4P7fWFTVlexNJ2vGNeAjHHsTTAQFFpFUyZVY</span> <span class="n">jorge</span>
<span class="n">The</span> <span class="n">key</span><span class="s1">&#39;s randomart image is:</span>
<span class="o">+---</span><span class="p">[</span><span class="n">RSA</span> <span class="mi">2048</span><span class="p">]</span><span class="o">----+</span>
<span class="o">|</span>         <span class="o">.</span><span class="n">OO</span><span class="o">%*</span><span class="n">BBE</span><span class="o">|</span>
<span class="o">|</span>         <span class="o">=</span> <span class="n">O</span><span class="o">=</span><span class="n">B</span><span class="o">++</span><span class="n">O</span><span class="o">|</span>
<span class="o">|</span>        <span class="o">.</span> <span class="o">+.=+</span><span class="n">o</span><span class="o">=+|</span>
<span class="o">|</span>         <span class="o">+</span> <span class="o">..</span><span class="n">o</span>  <span class="o">+|</span>
<span class="o">|</span>        <span class="n">S</span> <span class="o">.</span>   <span class="n">o</span> <span class="n">o</span><span class="o">|</span>
<span class="o">|</span>               <span class="n">o</span><span class="o">+|</span>
<span class="o">|</span>               <span class="n">o</span><span class="o">.|</span>
<span class="o">|</span>              <span class="o">.</span>  <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span>
<span class="o">+----</span><span class="p">[</span><span class="n">SHA256</span><span class="p">]</span><span class="o">-----+</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Upload the public key: While on the <strong>Compute Engine</strong> dashboard, select the <strong>Metadata</strong> option from the left navigation menu (you can go directly by entering this URL <a class="reference external" href="https://console.cloud.google.com/compute/metadata/sshKeys">https://console.cloud.google.com/compute/metadata/sshKeys</a>). Click on <strong>Edit</strong>, <strong>+ Add Item</strong> and paste the contents of your public key.  Using the example keys that were generated earlier, this will be the content of the <cite>/home/jorge/.ssh/id_gcp.pub</cite> file.</p>
</li>
<li><p class="first">Save.  Test your connection by trying to login using ssh on your terminal.</p>
</li>
</ol>
</div>
<div class="section" id="run-a-linux-container">
<h3>Run a Linux Container<a class="headerlink" href="#run-a-linux-container" title="Permalink to this headline">¶</a></h3>
<p>Install Docker on the newly created machine:</p>
<ol class="arabic">
<li><p class="first">Execute the following commands:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">apt</span><span class="o">-</span><span class="n">transport</span><span class="o">-</span><span class="n">https</span> <span class="n">ca</span><span class="o">-</span><span class="n">certificates</span> <span class="n">curl</span> <span class="n">software</span><span class="o">-</span><span class="n">properties</span><span class="o">-</span><span class="n">common</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">fsSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">gpg</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
<span class="n">sudo</span> <span class="n">add</span><span class="o">-</span><span class="n">apt</span><span class="o">-</span><span class="n">repository</span> <span class="s2">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Test your installation</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">docker</span> <span class="n">run</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Run apache webserver container in the background</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span><span class="p">:</span><span class="mi">80</span> <span class="n">httpd</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Verify the container is running</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">docker</span> <span class="n">ps</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Open a web browser and browse to the External IP Address of your Virtual Machine</p>
</li>
</ol>
</div>
</div>
<div class="section" id="stop-the-virtual-machine">
<h2>Stop the Virtual Machine<a class="headerlink" href="#stop-the-virtual-machine" title="Permalink to this headline">¶</a></h2>
<p>Once you have finished the previous steps, go back to the <strong>VM instance dashboard</strong> and stop the instance.</p>
</div>
<div class="section" id="report">
<h2>Report<a class="headerlink" href="#report" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Contrast the process of provisioning a physical server versus the process of creating a VM instance.  Evaluate the pros and cons of each.</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>